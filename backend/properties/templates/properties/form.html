{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}{% if property %}Edit Property{% else %}Add New Property{% endif %} - EstateHub{% endblock %}

{% block content %}
<div style="max-width: 900px; margin: 2rem auto;">
    <div style="background: white; padding: 2rem; border-radius: 12px; box-shadow: var(--shadow-lg);">
        <h2 style="margin-bottom: 2rem;">
            {% if property %}
            {% if language == 'ar' %}ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±{% else %}Edit Property{% endif %}
            {% else %}
            {% if language == 'ar' %}Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø± Ø¬Ø¯ÙŠØ¯{% else %}Add New Property{% endif %}
            {% endif %}
        </h2>

        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <div style="background: var(--bg-light); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                    ğŸ“ {% if language == 'ar' %}Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©{% else %}English Information{% endif %}
                </h3>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Title (English) *</label>
                    {{ form.title_en }}
                    {% if form.title_en.errors %}
                    <small style="color: red;">{{ form.title_en.errors.0 }}</small>
                    {% endif %}
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description (English)
                        *</label>
                    {{ form.description_en }}
                    {% if form.description_en.errors %}
                    <small style="color: red;">{{ form.description_en.errors.0 }}</small>
                    {% endif %}
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Location (English) *</label>
                    {{ form.location_en }}
                    {% if form.location_en.errors %}
                    <small style="color: red;">{{ form.location_en.errors.0 }}</small>
                    {% endif %}
                </div>
            </div>

            <div style="background: var(--bg-light); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                    ğŸ“ {% if language == 'ar' %}Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©{% else %}Arabic Information{% endif %}
                </h3>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ø¹Ø±Ø¨ÙŠ) *</label>
                    {{ form.title_ar }}
                    {% if form.title_ar.errors %}
                    <small style="color: red;">{{ form.title_ar.errors.0 }}</small>
                    {% endif %}
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Ø§Ù„ÙˆØµÙ (Ø¹Ø±Ø¨ÙŠ) *</label>
                    {{ form.description_ar }}
                    {% if form.description_ar.errors %}
                    <small style="color: red;">{{ form.description_ar.errors.0 }}</small>
                    {% endif %}
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø¹Ø±Ø¨ÙŠ) *</label>
                    {{ form.location_ar }}
                    {% if form.location_ar.errors %}
                    <small style="color: red;">{{ form.location_ar.errors.0 }}</small>
                    {% endif %}
                </div>
            </div>

            <div style="background: var(--bg-light); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                    ğŸ’° {% if language == 'ar' %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±{% else %}Property Details{% endif %}
                </h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                            {% if language == 'ar' %}Ø§Ù„Ø³Ø¹Ø±{% else %}Price{% endif %} *
                        </label>
                        {{ form.price }}
                        {% if form.price.errors %}
                        <small style="color: red;">{{ form.price.errors.0 }}</small>
                        {% endif %}
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                            {% if language == 'ar' %}Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±{% else %}Property Type{% endif %} *
                        </label>
                        {{ form.property_type }}
                        {% if form.property_type.errors %}
                        <small style="color: red;">{{ form.property_type.errors.0 }}</small>
                        {% endif %}
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                            {% if language == 'ar' %}Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ¹{% else %}Sale Type{% endif %} *
                        </label>
                        {{ form.sale_type }}
                        {% if form.sale_type.errors %}
                        <small style="color: red;">{{ form.sale_type.errors.0 }}</small>
                        {% endif %}
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                            {% if language == 'ar' %}Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ{% else %}Phone{% endif %} *
                        </label>
                        {{ form.phone }}
                        {% if form.phone.errors %}
                        <small style="color: red;">{{ form.phone.errors.0 }}</small>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div style="background: var(--bg-light); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                    ğŸ“¸ {% if language == 'ar' %}Ø§Ù„ØµÙˆØ±{% else %}Images{% endif %}
                </h3>

                <p style="color: var(--text-light); margin-bottom: 1rem;">
                    {% if language == 'ar' %}
                    Ù‚Ù… Ø¨Ø±ÙØ¹ Ø­ØªÙ‰ 10 ØµÙˆØ± Ù„Ù„Ø¹Ù‚Ø§Ø± (ÙŠÙØ¶Ù„ ØµÙˆØ± Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©)
                    {% else %}
                    Upload up to 10 images (high quality recommended)
                    {% endif %}
                </p>

                {{ formset.management_form }}

                <div id="image-forms">
                    {% for form in formset %}
                    <div class="image-form"
                        style="margin-bottom: 1rem; padding: 1rem; background: white; border-radius: 8px; border: 2px dashed var(--border-color);">
                        <div style="display: grid; grid-template-columns: 1fr auto; gap: 1rem; align-items: center;">
                            <div>
                                {{ form.image }}
                                {{ form.order }}
                                {{ form.id }}
                            </div>
                            <div>
                                {% if form.instance.pk %}
                                {{ form.DELETE }}
                                <label>Delete</label>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                <a href="{% url 'property_list' %}" class="btn btn-secondary">
                    {% if language == 'ar' %}Ø¥Ù„ØºØ§Ø¡{% else %}Cancel{% endif %}
                </a>
                <button type="submit" class="btn btn-primary" style="padding: 1rem 2rem;">
                    ğŸ’¾ {% if property %}
                    {% if language == 'ar' %}ØªØ­Ø¯ÙŠØ«{% else %}Update{% endif %}
                    {% else %}
                    {% if language == 'ar' %}Ø¥Ø¶Ø§ÙØ©{% else %}Add Property{% endif %}
                    {% endif %}
                </button>
            </div>
        </form>
    </div>
</div>

<style>
    input[type="text"],
    input[type="number"],
    textarea,
    select {
        width: 100%;
        padding: 0.75rem;
        border: 2px solid var(--border-color);
        border-radius: 8px;
        font-size: 1rem;
    }

    textarea {
        min-height: 100px;
        resize: vertical;
    }

    input[type="file"] {
        padding: 0.5rem;
    }
</style>
{% endblock %}